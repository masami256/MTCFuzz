From 1e49b4b38eea30048cee8edc6eb436b8e298476d Mon Sep 17 00:00:00 2001
From: Masami Ichikawa <masami256@gmail.com>
Date: Fri, 11 Jul 2025 23:19:43 +0900
Subject: [PATCH] Add kernel parameters for fuzzing

Add some kernel parameters to make fuzzing friendly.

Signed-off-by: Masami Ichikawa <masami256@gmail.com>
---
 kconfigs/u-boot_qemu_v8.conf | 2 +-
 qemu_v8.mk                   | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/kconfigs/u-boot_qemu_v8.conf b/kconfigs/u-boot_qemu_v8.conf
index 619879c..a532103 100644
--- a/kconfigs/u-boot_qemu_v8.conf
+++ b/kconfigs/u-boot_qemu_v8.conf
@@ -1,3 +1,3 @@
 CONFIG_SYS_TEXT_BASE=0x60000000
-CONFIG_BOOTCOMMAND="setenv kernel_addr_r 0x42200000 && setenv ramdisk_addr_r 0x46000000 && load hostfs - ${kernel_addr_r} uImage && load hostfs - ${ramdisk_addr_r} rootfs.cpio.uboot &&  setenv bootargs console=ttyAMA0,115200 earlyprintk=serial,ttyAMA0,115200 root=/dev/ram && bootm ${kernel_addr_r} ${ramdisk_addr_r} ${fdt_addr}"
+CONFIG_BOOTCOMMAND="setenv kernel_addr_r 0x42200000 && setenv ramdisk_addr_r 0x46000000 && load hostfs - ${kernel_addr_r} uImage && load hostfs - ${ramdisk_addr_r} rootfs.cpio.uboot &&  setenv bootargs console=ttyAMA0,115200 earlyprintk=serial,ttyAMA0,115200 nokaslr oops=panic panic_on_warn=1 panic_on_oops=1 root=/dev/ram && bootm ${kernel_addr_r} ${ramdisk_addr_r} ${fdt_addr}"
 CONFIG_SEMIHOSTING=y
diff --git a/qemu_v8.mk b/qemu_v8.mk
index 0589fd1..b3984a6 100644
--- a/qemu_v8.mk
+++ b/qemu_v8.mk
@@ -599,7 +599,7 @@ QEMU_BASE_ARGS += -m $(QEMU_MEM)
 QEMU_BASE_ARGS += -bios bl1.bin
 QEMU_BASE_ARGS += -initrd rootfs.cpio.gz
 QEMU_BASE_ARGS += -kernel Image
-QEMU_BASE_ARGS += -append 'console=ttyAMA0,38400 keep_bootcon root=/dev/vda2 $(QEMU_KERNEL_BOOTARGS)'
+QEMU_BASE_ARGS += -append 'console=ttyAMA0,38400 keep_bootcon nokaslr oops=panic panic_on_warn=1 panic_on_oops=1 root=/dev/vda2 $(QEMU_KERNEL_BOOTARGS)'
 QEMU_BASE_ARGS += $(QEMU_XEN)
 QEMU_BASE_ARGS += $(QEMU_EXTRA_ARGS)
 QEMU_BASE_ARGS += -machine virt,acpi=off,secure=on,mte=$(QEMU_MTE),gic-version=$(QEMU_GIC_VERSION),virtualization=$(QEMU_VIRT)
-- 
2.50.1

